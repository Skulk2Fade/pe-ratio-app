{% extends "base.html" %}
{% block title %}Portfolio{% endblock %}
{% block content %}
<div class="container py-5">
  <h3 class="mb-4">{{ user.username }}'s Portfolio</h3>
  {% if following %}
  <a href="{{ url_for('portfolio.follow_portfolio', username=user.username) }}" class="btn btn-secondary mb-3">Unfollow</a>
  {% else %}
  <a href="{{ url_for('portfolio.follow_portfolio', username=user.username) }}" class="btn btn-primary mb-3">Follow</a>
  {% endif %}
  {% if items %}
  <ul class="list-group">
    {% for item in items %}
    <li class="list-group-item">
      <strong>{{ item.symbol }}</strong> - {{ item.quantity }} @ {{ item.price_paid }}
    </li>
    {% endfor %}
  </ul>
  {% else %}
  <p>No holdings.</p>
  {% endif %}
  <h4 class="mt-4">Comments</h4>
  {% if comments %}
  <ul class="list-group mb-3">
    {% for c in comments %}
    <li class="list-group-item">
      <strong>{{ c.user.username }}</strong>
      <small class="text-muted">{{ c.timestamp.strftime('%Y-%m-%d %H:%M') }}</small>
      <p class="mb-0">{{ c.content }}</p>
    </li>
    {% endfor %}
  </ul>
  {% else %}
  <p>No comments yet.</p>
  {% endif %}
  {% if current_user.is_authenticated %}
  <form method="POST" action="{{ url_for('portfolio.comment_portfolio', username=user.username) }}" class="mb-3">
    {{ comment_form.hidden_tag() }}
    {{ comment_form.content(class="form-control mb-2", placeholder="Add a comment") }}
    <button class="btn btn-primary" type="submit">Post</button>
  </form>
  {% else %}
  <p><a href="{{ url_for('auth.login') }}">Log in</a> to comment.</p>
  {% endif %}
  <a href="{{ url_for('main.index') }}" class="btn btn-secondary mt-3">Back</a>
</div>
{% endblock %}
